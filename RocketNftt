-- Remote packet size(~): 20 bytes

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")

local LocalPlayer = Players.LocalPlayer

-- Функция для поиска самого дорогого подарка в инвентаре
local function findMostExpensiveGift()
    local backpack = LocalPlayer.Backpack or LocalPlayer:FindFirstChild("Backpack")
    local playerGui = LocalPlayer:FindFirstChild("PlayerGui")
    
    if not backpack and not playerGui then
        warn("Не удалось найти инвентарь игрока")
        return "Lol Pop (Gold Star)" -- значение по умолчанию
    end
    
    local mostExpensiveGift = nil
    local highestPrice = 0
    
    -- Поиск в Backpack
    if backpack then
        for _, item in ipairs(backpack:GetChildren()) do
            if item:IsA("Tool") or item:IsA("HopperBin") then
                -- Проверяем различные возможные свойства с ценой
                local price = 0
                
                -- Пытаемся получить цену из разных свойств
                if item:FindFirstChild("Price") then
                    price = item.Price.Value or 0
                elseif item:FindFirstChild("Cost") then
                    price = item.Cost.Value or 0
                elseif item:FindFirstChild("Value") and string.find(item.Value.Name:lower(), "price") then
                    price = item.Value.Value or 0
                end
                
                if price > highestPrice then
                    highestPrice = price
                    mostExpensiveGift = item.Name
                end
            end
        end
    end
    
    -- Поиск в PlayerGui (для некоторых игр)
    if playerGui then
        local inventoryFrames = playerGui:FindFirstChild("Inventory") or playerGui:FindFirstChild("Backpack")
        if inventoryFrames then
            for _, frame in ipairs(inventoryFrames:GetDescendants()) do
                if frame:IsA("TextButton") or frame:IsA("ImageButton") then
                    local itemName = frame.Name
                    if frame:FindFirstChild("Price") then
                        local price = frame.Price.Text and tonumber(frame.Price.Text:gsub("%D", "")) or 0
                        if price > highestPrice then
                            highestPrice = price
                            mostExpensiveGift = itemName
                        end
                    end
                end
            end
        end
    end
    
    return mostExpensiveGift or "Lol Pop (Gold Star)"
end

-- Получаем самый дорогой подарок
local mostExpensiveGift = findMostExpensiveGift()

local Rocket = ReplicatedStorage.Events.Rocket -- RemoteFunction 

-- Используем самый дорогой поддарок
Rocket:InvokeServer(
    [mostExpensiveGift],
    "Play"
)

-- Decompiler will be improved VERY SOON!
-- Decompiled with Konstant V2.1, a fast Luau decompiler made in Luau by plusgiant5 (https://discord.gg/brNTY8nX8t)
-- Decompiled on 2025-11-02 11:37:41
-- Luau version 6, Types version 3
-- Time taken: 0.000262 seconds

local Parent = script.Parent
Parent.Display.Text = LocalPlayer.DisplayName
Parent.Username.Text = '@'..LocalPlayer.Name
Parent.AvatarFrame.Image.Image = "https://www.roblox.com/headshot-thumbnail/image?userId="..LocalPlayer.UserId.."&width=150&height=150&format=png"
