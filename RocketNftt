local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Events = ReplicatedStorage:WaitForChild("Events")
local LocalPlayer = Players.LocalPlayer
local _Inventory = LocalPlayer:WaitForChild("_Inventory")
local module = require(ReplicatedStorage:WaitForChild("Info"))

local AutoRocket = {}

function AutoRocket.GetMostExpensiveGift()
    local mostExpensive = nil
    local highestPrice = 0
    
    for _, gift in pairs(module.Gifts) do
        if gift.Price > highestPrice and not gift.Limited and gift.Price > 100 then
            highestPrice = gift.Price
            mostExpensive = gift
        end
    end
    
    return mostExpensive
end

function AutoRocket.FindGiftInstance(giftName)
    for _, item in ipairs(_Inventory:GetChildren()) do
        if item.Name == giftName then
            return item
        end
    end
    return nil
end

function AutoRocket.PlayRocket()
    local giftData = AutoRocket.GetMostExpensiveGift()
    if not giftData then
        warn("–ù–µ –Ω–∞–π–¥–µ–Ω –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–æ–¥–∞—Ä–æ–∫ –¥–ª—è —Ä–∞–∫–µ—Ç–∫–∏")
        return false
    end
    
    local giftInstance = AutoRocket.FindGiftInstance(giftData.Name)
    if not giftInstance then
        warn("–ü–æ–¥–∞—Ä–æ–∫ " .. giftData.Name .. " –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ")
        return false
    end
    
    -- –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞–∫–µ—Ç–∫—É
    local success, result = Events.Rocket:InvokeServer(giftInstance, "Play")
    
    if success then
        print("üéØ –†–∞–∫–µ—Ç–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞ —Å –ø–æ–¥–∞—Ä–∫–æ–º: " .. giftData.Name .. " (–¶–µ–Ω–∞: ‚≠ê " .. giftData.Price .. ")")
        
        -- –ñ–¥–µ–º –ø–æ–∫–∞ –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç 1.08x
        local startTime = tick()
        local maxWaitTime = 30 -- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        
        while tick() - startTime < maxWaitTime do
            wait(0.1)
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–∏–π –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä (—ç—Ç–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –≤–∞—à UI)
            -- –í –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–¥–µ –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Multiplier.Text
            local multiplierText = script.Parent:FindFirstChild("Multiplier")
            if multiplierText then
                local multiplierValue = tonumber(string.match(multiplierText.Text, "x([%d%.]+)"))
                if multiplierValue and multiplierValue >= 1.08 then
                    -- –ó–∞–±–∏—Ä–∞–µ–º –≤—ã–∏–≥—Ä—ã—à
                    local claimSuccess, claimResult = Events.Rocket:InvokeServer(giftInstance, "Claim")
                    if claimSuccess then
                        print("‚úÖ –í—ã–∏–≥—Ä—ã—à –∑–∞–±—Ä–∞–Ω –Ω–∞ " .. multiplierValue .. "x")
                        return true
                    else
                        warn("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—ã–∏–≥—Ä—ã—à–∞: " .. tostring(claimResult))
                        return false
                    end
                end
            end
        end
        
        warn("‚è∞ –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ, –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä –Ω–µ –¥–æ—Å—Ç–∏–≥ 1.08x")
        return false
    else
        warn("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ä–∞–∫–µ—Ç–∫–∏: " .. tostring(result))
        return false
    end
end

function AutoRocket.StartAutoFarm(interval)
    interval = interval or 5 -- –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    
    print("ü§ñ –ê–≤—Ç–æ-—Ñ–µ—Ä–º–∞ —Ä–∞–∫–µ—Ç–∫–∏ –∑–∞–ø—É—â–µ–Ω–∞!")
    print("üìä –ò–Ω—Ç–µ—Ä–≤–∞–ª: " .. interval .. " —Å–µ–∫—É–Ω–¥")
    print("üéØ –¶–µ–ª–µ–≤–æ–π –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä: 1.08x")
    
    while true do
        local success = AutoRocket.PlayRocket()
        
        if success then
            print("üîÑ –û–∂–∏–¥–∞–Ω–∏–µ " .. interval .. " —Å–µ–∫—É–Ω–¥ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞...")
        else
            print("üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ " .. interval .. " —Å–µ–∫—É–Ω–¥...")
        end
        
        wait(interval)
    end
end

-- –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ-—Ñ–µ—Ä–º—ã (–º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é)
-- AutoRocket.StartAutoFarm(5)

return AutoRocket
